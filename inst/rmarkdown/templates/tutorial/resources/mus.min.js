/*!
 * Mus.js v1.1.0 adapted by Markus Konrad <markus.konrad@htw-berlin.de>
 *
 * Original code:
 * (c) 2018 Mauricio Giordano <giordano@inevent.us> - InEvent
 * Released under the MIT License.
 */(function(l,c){typeof exports=="object"&&typeof module<"u"?module.exports=c():typeof define=="function"&&define.amd?define(c):l.Mus=c()})(this,function(){"use strict";const l="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCSB2aWV3Qm94PSIwIDAgMjggMjgiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI4IDI4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBwb2ludHM9IjguMiwyMC45IDguMiw0LjkgMTkuOCwxNi41IDEzLDE2LjUgMTIuNiwxNi42ICIvPjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHBvaW50cz0iMTcuMywyMS42IDEzLjcsMjMuMSA5LDEyIDEyLjcsMTAuNSAiLz48cmVjdCB4PSIxMi41IiB5PSIxMy42IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjkyMjEgLTAuMzg3MSAwLjM4NzEgMC45MjIxIC01Ljc2MDUgNi41OTA5KSIgd2lkdGg9IjIiIGhlaWdodD0iOCIvPjxwb2x5Z29uIHBvaW50cz0iOS4yLDcuMyA5LjIsMTguNSAxMi4yLDE1LjYgMTIuNiwxNS41IDE3LjQsMTUuNSAiLz48L3N2Zz4=";function c(){if(this===void 0){console.error('Have you initialized Mus with "new" statement? (i.e. var mus = new Mus())');return}this.frames=[],this.timeouts=[],this.pos=0,this.currPos=0,this.startedAt=0,this.startedAtISODate=null,this.finishedAt=0,this.timePoint=!1,this.recordInputs=!0,this.recordCurrentElem=!1,this.curElemXPath=null,this.curElemCSSPath=null,this.recording=!1,this.clickHighlightTimeout=5e3,this.playing=!1,this.playbackSpeed=this.speed.NORMAL,this.observer="",this.curWindowResizeEventListener=null,this.window={width:window.outerWidth,height:window.outerHeight},this.onmousemove=window.onmousemove,this.onmousedown=window.onmousedown,this.onscroll=window.onscroll,this.inputWithUserKeyEvent=()=>{document.querySelectorAll("textarea, input[type=text], input[type=email], input[type=number], input[type=tel], input[type=search], input[type=url], input[type=search], input[type=week], input[type=month], input[type=datetime-local]").forEach(e=>{e.onkeydown=null})},this.inputWithOnchangeEvent=()=>{document.querySelectorAll("select, input[type=checkbox], input[type=radio], input[type=color], input[type=date], input[type=file], input[type=number], input[type=range], input[type=time]").forEach(e=>{e.onchange=null})}}return c.prototype={windowResizeListener:function(e){return function(t){if(e){const i=["w",window.innerWidth,window.innerHeight];e(i)}}},moveListener:function(e){const t=this;return function(i){if(e){const n=["m",i.clientX,i.clientY];if(t.recordCurrentElem){const o=t.getXpathFromElement(i.target);n.push(t.curElemXPath===o?null:o);const r=t.getCSSPath(i.target);n.push(t.curElemCSSPath===r?null:r),t.curElemXPath=o,t.curElemCSSPath=r}e(n)}}},clickListener:function(e){const t=this;return function(i){if(e){const n=["c",i.clientX,i.clientY];t.recordCurrentElem&&(n.push(t.getXpathFromElement(i.target)),n.push(t.getCSSPath(i.target))),e(n)}}},scrollListener:function(e){return function(t){e&&e(["s",document.scrollingElement.scrollLeft,document.scrollingElement.scrollTop])}},inputWithUserKeyListener:function(e){const t=this;return function(i){e&&e(["i",t.getXpathFromElement(i.target),t.getCSSPath(i.target),i.target.value])}},inputWithOnchangeListener:function(e){const t=this;return function(i){e&&e(["o",t.getXpathFromElement(i.target),t.getCSSPath(i.target),i.target.value])}},mutationObserver:function(e){return function(t){e&&e(t)}},record:function(e){if(this.recording)return;const t=this;if(t.startedAt===0){const i=new Date;t.startedAt=i.getTime()/1e3,t.startedAtISODate=i.toISOString()}if(t.timePoint?t.frames.push(["s",document.scrollingElement.scrollLeft,document.scrollingElement.scrollTop,0]):t.frames.push(["s",document.scrollingElement.scrollLeft,document.scrollingElement.scrollTop]),t.recordInputs&&(document.querySelectorAll("textarea, input[type=text], input[type=email], input[type=number], input[type=tel], input[type=search], input[type=url], input[type=search], input[type=week], input[type=month], input[type=datetime-local]").forEach(i=>{t.timePoint?t.frames.push(["i",t.getXpathFromElement(i),t.getCSSPath(i),i.value,0]):t.frames.push(["i",t.getXpathFromElement(i),t.getCSSPath(i),i.value])}),document.querySelectorAll("select, input[type=checkbox], input[type=radio], input[type=color], input[type=date], input[type=file], input[type=number], input[type=range], input[type=time]").forEach(i=>{t.timePoint?i.type==="checkbox"||i.type==="radio"?t.frames.push(["o",t.getXpathFromElement(i),t.getCSSPath(i),i.value,i.checked,0]):t.frames.push(["o",t.getXpathFromElement(i),t.getCSSPath(i),i.value,0]):i.type==="checkbox"||i.type==="radio"?t.frames.push(["o",t.getXpathFromElement(i),t.getCSSPath(i),i.value,i.checked]):t.frames.push(["o",t.getXpathFromElement(i),t.getCSSPath(i),i.value])})),this.curWindowResizeEventListener=this.windowResizeListener(function(i){t.frames.push(t.timePoint?i.concat(new Date().getTime()-t.startedAt*1e3):i),e instanceof Function&&e()}),window.addEventListener("resize",this.curWindowResizeEventListener,!0),window.onmousemove=this.moveListener(function(i){t.frames.push(t.timePoint?i.concat(new Date().getTime()-t.startedAt*1e3):i),e instanceof Function&&e()}),window.onmousedown=this.clickListener(function(i){t.frames.push(t.timePoint?i.concat(new Date().getTime()-t.startedAt*1e3):i),e instanceof Function&&e()}),window.onscroll=this.scrollListener(function(i){t.frames.push(t.timePoint?i.concat(new Date().getTime()-t.startedAt*1e3):i),e instanceof Function&&e()}),t.recordInputs){document.querySelectorAll("textarea, input[type=text], input[type=email], input[type=number], input[type=tel], input[type=search], input[type=url], input[type=search], input[type=week], input[type=month], input[type=datetime-local]").forEach(r=>{r.oninput=this.inputWithUserKeyListener(function(s){t.frames.push(t.timePoint?s.concat(new Date().getTime()-t.startedAt*1e3):s),e instanceof Function&&e()})}),document.querySelectorAll("select, input[type=checkbox], input[type=radio], input[type=color], input[type=date], input[type=file], input[type=number], input[type=range], input[type=time]").forEach(r=>{r.onchange=this.inputWithOnchangeListener(function(s){const u=t.getElementByXpath(s[1]);u.type==="checkbox"||u.type==="radio"?(s=s.concat(u.checked),t.frames.push(t.timePoint?s.concat(new Date().getTime()-t.startedAt*1e3):s)):t.frames.push(t.timePoint?s.concat(new Date().getTime()-t.startedAt*1e3):s),e instanceof Function&&e()})});const i=document.querySelector("body"),n={attributes:!0,attributeOldValue:!0,subtree:!0},o=window.MutationObserver||window.WebKitMutationObserver;this.observer=new o(this.mutationObserver(function(r){for(const s of r)if(s.type==="attributes"){let u=[];s.target.hasAttribute(s.attributeName)?u=["a",t.getXpathFromElement(s.target),t.getCSSPath(s.target),s.attributeName,s.target.getAttribute(s.attributeName),s.oldValue,"M"]:u=["a",t.getXpathFromElement(s.target),t.getCSSPath(s.target),s.attributeName,s.oldValue,"D"],t.frames.push(t.timePoint?u.concat(new Date().getTime()-t.startedAt*1e3):u),e instanceof Function&&e()}})),this.observer.observe(i,n)}t.recording=!0},stop:function(){this.finishedAt=new Date().getTime()/1e3,window.removeEventListener("resize",this.curWindowResizeEventListener),this.curWindowResizeEventListener=null,window.onmousemove=this.onmousemove,window.onmousedown=this.onmousedown,window.onscroll=this.onscroll,this.inputWithUserKeyEvent(),this.inputWithOnchangeEvent(),this.observer!==""&&this.observer.disconnect(),this.timeouts=[],this.recording=!1,this.playing=!1,this.pos=0},pause:function(){this.playing&&(this.pos=this.currPos,this.playing=!1,this.clearTimeouts())},play:function(e){if(this.playing)return;const t=this;t.createCursor();const i=document.getElementById("musCursor");let n="",o=0;const r=t.pos;for(r>0&&(o=t.frames[r][t.frames[r].length-1]);t.pos<t.frames.length;t.pos++)t.timePoint?n=t.frames[t.pos][t.frames[t.pos].length-1]-o:n=(t.pos-r)*t.playbackSpeed,t.timeouts.push(setTimeout(function(s){t.playFrame(t,t.frames[s],i),t.currPos=s,s===t.frames.length-1&&(i.style.backgroundColor="transparent",t.timeouts=[],t.playing=!1,t.pos=0,e&&e())},n,t.pos));this.playing=!0},release:function(){this.frames=[],this.startedAt=0,this.startedAtISODate=null,this.finishedAt=0,this.stop(),this.destroyCursor(),this.destroyClickSnapshot()},playFrame:function(e,t,i){try{if(t[0]==="m"){const n=document.scrollingElement.scrollLeft,o=document.scrollingElement.scrollTop;i.style.left=n+t[1]+"px",i.style.top=o+t[2]+"px"}else if(t[0]==="c")e.createClickSnapshot(t[1],t[2]),e.getElementByXpath(t[3]).click();else if(t[0]==="s")window.scrollTo(t[1],t[2]);else if(t[0]==="S")document.querySelector("div.parallellayout.col.main").scrollTo(t[1],t[2]);else if(t[0]==="i"){const n=e.getElementByXpath(t[1]);n.value=t[3]}else if(t[0]==="o"){const n=e.getElementByXpath(t[1]);n.type==="checkbox"||n.type==="radio"?n.checked=t[4]:n.value=t[3]}else if(t[0]==="a"){const n=e.getElementByXpath(t[1]);t[6]==="M"?n.setAttribute(t[3],t[4]):t[5]==="D"&&n.removeAttribute(t[3])}}catch{}},clearTimeouts:function(){for(const e in this.timeouts)clearTimeout(this.timeouts[e]);this.timeouts=[]},timeElapsed:function(){return this.finishedAt-this.startedAt},createCursor:function(){if(!document.getElementById("musCursor")){const e=document.createElement("div");e.id="musCursor",e.style.position="absolute",e.style.width="32px",e.style.height="32px",e.style.borderRadius="32px",e.style.backgroundImage="url("+l+")",document.body.appendChild(e)}},destroyCursor:function(){const e=document.getElementById("musCursor");e&&e.remove()},createClickSnapshot:function(e,t){const i=document.scrollingElement.scrollLeft,n=document.scrollingElement.scrollTop,o=document.createElement("div");o.className="musClickSnapshot",o.style.position="absolute",o.style.width="32px",o.style.height="32px",o.style.top=t+n+"px",o.style.left=e+i+"px",o.style.borderRadius="32px",o.style.backgroundColor="red",o.style.opacity=.2,document.body.appendChild(o),window.setTimeout(function(){document.body.removeChild(o)},this.clickHighlightTimeout)},destroyClickSnapshot:function(){const e=document.getElementsByClassName("musClickSnapshot");for(;e.length>0;)e[0].remove()},getXCoordinate:function(e){return window.outerWidth>this.window.width?parseInt(this.window.width*e/window.outerWidth):parseInt(window.outerWidth*e/this.window.width)},getYCoordinate:function(e){return window.outerHeight>this.window.height?parseInt(this.window.height*e/window.outerHeight):parseInt(window.outerHeight*e/this.window.height)},getData:function(){return{frames:this.frames,startedAtISODate:this.startedAtISODate,timeElapsed:this.timeElapsed(),window:{width:window.outerWidth,height:window.outerHeight}}},isTimePoint:function(){return this.timePoint},setData:function(e){e.frames&&(this.frames=e.frames),e.window&&(this.window=e.window)},setFrames:function(e){this.frames=e},setWindowSize:function(e,t){this.window.width=e,this.window.height=t},setPlaybackSpeed:function(e){this.playbackSpeed=e},setTimePoint:function(e){this.timePoint=e},setRecordInputs:function(e){this.recordInputs=e},setRecordCurrentElem:function(e){this.recordCurrentElem=e},isRecording:function(){return this.recording},isPlaying:function(){return this.playing},speed:{SLOW:35,NORMAL:15,FAST:5},getCSSPath:function(e){const t=[];return $(e).parents().addBack().each((i,n)=>{const o=$(n);let r=o.prop("tagName").toLowerCase();o.attr("id")&&(r+="#"+o.attr("id")),o.attr("class")&&(r+="."+o.attr("class").split(" ").join(".")),t.push(r)}),t.join(" ")},getXpathFromElement:function(e){let t,i,n;for(i=[];e&&e.nodeType===1;e=e.parentNode){for(t=1,n=e.previousSibling;n;n=n.previousSibling)n.localName===e.localName&&t++;i.unshift(e.localName.toLowerCase()+"["+t+"]")}return i.length?"/"+i.join("/"):null},getElementByXpath:function(e){return new XPathEvaluator().evaluate(e,document.documentElement,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}},c});
//# sourceMappingURL=mus.min.js.map
