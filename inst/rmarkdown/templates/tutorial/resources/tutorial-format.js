(()=>{$(document).ready(function(){let w="",u=-1,R=!1,V=!1,r=[],S=new Set,y=!1,D=0,C=function(){let t=[];return{add:function(e,n){t.push({id:e,callback:n})},remove:function(e){t=t.filter(function(n){return e!==n.id})},invoke:function(){for(let e=0;e<t.length;e++)t[e].callback()}}}();function T(t,e){if(typeof e=="undefined"&&(e=!0),r.length===0||(t=t*1,t===u))return;if(u!==-1){let i=$(r[u].jqElement);i.trigger("hide"),i.removeClass("current"),i.trigger("hidden"),$(r[u].jqListElement).removeClass("current")}let n=$(r[t].jqElement);n.trigger("show"),n.addClass("current"),n.trigger("shown"),$(r[t].jqListElement).addClass("current"),u=t,e&&C.invoke(),setTimeout(function(){$(document).scrollTop(0)},0)}function x(t){let e=window.location.href.replace(window.location.hash,"");window.location=`${e}#${r[t].id}`}function K(t){F(),x(this.getAttribute("index"))}function W(){$(".topicsList").removeClass("hideFloating")}function F(){$(".topicsList").addClass("hideFloating")}function L(t){P();let e=r[t];if(!e.progressiveReveal)return;let n=!0,i=null;for(let o=0;o<e.sections.length;o++){let c=e.sections[o],s=$(c.jqElement);n?(s.trigger("show"),s.removeClass("hide"),s.trigger("shown"),c.skipped?s.removeClass("showSkip"):(s.addClass("showSkip"),i=s)):(s.trigger("hide"),s.addClass("hide"),s.trigger("hidden")),n=n&&c.skipped}!e.progressiveReveal||n?$(e.jqElement).removeClass("hideActions"):$(e.jqElement).addClass("hideActions"),y&&i&&(D=i.offset().top-28,setTimeout(function(){$("html, body").animate({scrollTop:D},300)},60)),y=!1}function B(t){let e=r[t],n=e.sections.length===0?!e.topicCompleted*100:(1-e.sectionsSkipped/e.sections.length)*100;$(e.jqListElement).css("background-position-y",n+"%")}function q(t){return i18next.language||window.localStorage.i18nextLng||t||"en"}function Y(t){$(this).data("n_clicks",$(this).data("n_clicks")+1);let e=this.getAttribute("data-section-id"),n=-1,i=-1,o,c;if($.each(r,function(s,a){return $.each(a.sections,function(l,p){if(e===p.id)return n=s,i=l,o=a,c=p,!1}),n===-1}),c.exercises.length&&!c.completed&&!c.allowSkip){let s=i18next.t(["text.exercise","exercise"],{count:c.exercises.length,lngs:[q(),"en"]}),a=i18next.t(["text.youmustcomplete","You must complete the"]),l=i18next.t(["text.inthissection","in this section before continuing."]);bootbox.setLocale(q()),bootbox.alert(a+" "+s+" "+l)}else i===o.sections.length-1?n<r.length-1&&x(u+1):y=!0,U([c.jqElement]),tutorial.skipSection(e)}function G(t){r[u].sections.length===0&&tutorial.skipSection(r[u].id),x(u+1)}function J(t){x(u-1)}function Q(){let t=$('<nav id="tutorial-topic" class="topicsList hideFloating" aria-label="topic"></nav>'),e=$('<header class="topicsHeader"></header>');e.append($('<h1 class="tutorialTitle">'+w+"</h1>"));let n=$('<div class="paneCloser"></div>');n.on("click",F),e.append(n),t.append(e);let i=I()?$('<ul class="nav nav-pills" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>'):$('<ul class="nav flex-column" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>');t.append(i),$("#doc-metadata").before(t),P();let o=$(".section.level2");o.each(function(s,a){let l={};l.id=$(a).attr("id"),l.exercisesCompleted=0,l.sectionsCompleted=0,l.sectionsSkipped=0,l.topicCompleted=!1,l.jqElement=a,l.jqTitleElement=$(a).children("h2")[0],l.titleText=l.jqTitleElement.innerText;let p=$(a).attr("data-progressive");typeof p!="undefined"&&p!==!1?l.progressiveReveal=p==="true"||p==="TRUE":l.progressiveReveal=R;let b=$(`<li class="topic${I()?"":" nav-item"}" index="${s}"><a href="#${l.id}" class = "nav-link" role="menuitem" tabindex="0">${l.titleText}</a></li>`);b.on("click",K),l.jqListElement=b,$(i).append(b);let j=$('<div class="topicActions"></div>');if(s>0){let h=$('<button class="btn btn-default" data-i18n="button.previoustopic">Previous Topic</button>');h.on("click",J),j.append(h)}if(s<o.length-1){let h=$('<button class="btn btn-primary" data-i18n="button.nexttopic">Next Topic</button>');h.on("click",G),j.append(h)}$(a).append(j),$(a).on("shown",function(){$(this).is(":visible")&&$(a).children(".section.level3").each(function(d,f){k(f)})}),$(a).on("hidden",function(){$(a).children(".section.level3").each(function(d,f){k(f)})}),l.sections=[],$(a).children(".section.level3").each(function(h,d){if(l.progressiveReveal){let O='data-i18n="button.continue"',v="Continue";d.dataset.continueText&&(v=d.dataset.continueText,O="");let g=$(`<button
              class="btn btn-default skip"
              id="continuebutton-${d.id}"
              data-section-id="${d.id}"
              ${O}
            >${v}</button>`);g.data("n_clicks",0),g.on("click",Y);let E=$('<div class="exerciseActions"></div>');E.append(g),$(d).append(E)}$(d).on("shown",function(){k(d)}),$(d).on("hidden",function(){k(d)});let f={};f.exercises=[],$(d).children(".tutorial-exercise").each(function(O,v){let g={};g.dataLabel=$(v).attr("data-label"),g.completed=!1,g.jqElement=v,f.exercises.push(g)});let M=$(d).attr("data-allow-skip"),z=V;typeof M!="undefined"&&M!==!1&&(z=M="true"),f.id=d.id,f.completed=!1,f.allowSkip=z,f.skipped=!1,f.jqElement=d,l.sections.push(f)}),r.push(l)});let c=$('<li class="resetButton"><a href="#" data-i18n="text.startover">Start Over</a></li>');return c.on("click",function(){let s=i18next.t(["text.areyousure","Are you sure you want to start over? (all exercise progress will be reset)"]);bootbox.setLocale(q()),bootbox.confirm(s,function(a){a&&tutorial.startOver()})}),$("#doc-metadata-additional ul").prepend(c),t}let _=new Shiny.InputBinding;$.extend(_,{find:function(t){return $(t).find(".topicsList")},getValue:function(t){return u===-1?null:r[u].id},setValue:function(t,e){for(let n=0;n<r.length;n++)if(r[n].id===e){T(n,!1);break}},subscribe:function(t,e){C.add(t.id,e)},unsubscribe:function(t){C.remove(t.id)}}),Shiny.inputBindings.register(_,"learnr.topicMenuInputBinding");let H=new Shiny.InputBinding;$.extend(H,{find:function(t){return $(t).find(".exerciseActions > button.skip")},getId:function(t){return"continuebutton-"+t.getAttribute("data-section-id")},getValue:function(t){return $(t).data("n_clicks")},setValue:function(t,e){let n=$(t).data("n_clicks");e>n&&$(t).trigger("click"),$(t).data("n_clicks",e)},subscribe:function(t,e){$(t).on("click.continueButtonInputBinding",function(n){e(!1)})},unsubscribe:function(t){$(t).off(".continueButtonInputBinding")}}),Shiny.inputBindings.register(H,"learnr.continueButtonInputBinding");function X(){w=$("title")[0].innerText;let t=$("meta[name=progressive]").attr("content");R=t==="true"||t==="TRUE";let e=$("meta[name=allow-skip]").attr("content");V=e==="true"||e==="TRUE";let n=$(`<h1 class="tutorialTitle">${w}</h1>`);n.on("click",W),$(".topics").prepend(n),$(".bandContent.topicsListContainer").append(Q());for(let o=0;o<r.length;o++)L(o);Z();function i(){$(".topicsList").css("max-height",window.innerHeight)}i(),window.addEventListener("resize",i)}function Z(){$(".footnote-ref").replaceWith(function(){let t=$("<span>");return t.addClass($(this).class),t.append($(this).html()),t}),$(".footnote-back").remove()}function I(){return!window.bootstrap}function tt(){if(I())return;document.querySelectorAll(".btn-xs").forEach(n=>{n.classList.remove("btn-xs"),n.classList.add("btn-sm")}),document.querySelectorAll(".sr-only").forEach(n=>{n.classList.contains("visually-hidden-focusable")||n.classList.add("visually-hidden")});let t={panel:"card","panel-default":"","panel-heading":"card-header","panel-title":"card-title","panel-body":"card-body","panel-footer":"card-footer"},e=document.querySelectorAll(".tutorial-exercise-input, .tutorial-question-container");e.length!==0&&e.forEach(n=>{Object.keys(t).forEach(i=>{let o=[n,...n.querySelectorAll(`.${i}`)];if(!o.length)return;let c=t[i];o.forEach(s=>{!s.classList.contains(i)||(s.classList.remove(i),c!==""&&s.classList.add(c))})})})}function et(){function t(){let e=window.decodeURIComponent(window.location.hash),n=0;return e.length>0&&$.each(r,function(i,o){if("#"+o.id===e)return n=i,!1}),n}T(t()),window.addEventListener("popstate",function(e){T(t())})}function nt(t){let e=$(t),n=e.hasClass("level2"),i;n?i=e.attr("id"):i=$(e.parents(".section.level2")).attr("id");let o=-1;if($.each(r,function(s,a){if(a.id===i)return o=s,!1}),o===-1){console.log('topic "'+i+'" not found');return}let c=r[o];if(n)c.topicCompleted=!0,B(o);else{let s=-1,a=e.attr("id");if($.each(c.sections,function(p,b){if(b.id===a)return s=p,!1}),s===-1){console.log('completed section"'+a+'"not found');return}let l=c.sections[s];l.completed||(c.sectionsCompleted++,B(o),$(l.jqElement).addClass("done"),l.completed=!0,L(o))}}let m=[];function P(){m.splice(0,m.length),A()}function k(t){let e=m.indexOf(t.id);$(t).is(":visible")?e===-1&&(m.push(t.id),A()):e!==-1&&(m.splice(e,1),A())}function A(){Shiny&&Shiny.setInputValue?Shiny.setInputValue("tutorial-visible-sections",m):$(document).on("shiny:sessioninitialized",function(){Shiny.setInputValue("tutorial-visible-sections",m)})}function U(t){let e;if(t.length)e=t[0].id;else{console.log("section "+$(t).selector.split('"')[1]+" not found");return}let n=-1;$.each(r,function(i,o){return e===o.id?(n=i,o.topicCompleted=!0,!1):($.each(o.sections,function(c,s){if(e===s.id)return n=i,s.skipped=!0,o.sectionsSkipped++,!1}),n===-1)}),B(n),L(n)}function N(t){function e(){let o=`${u}.${t}`;if(!S.has(o)){let c=$(`.section.level2:eq(${u})  .summary:eq(${t})`).children();c.css("opacity","0%").css("background-color","white"),$("#summarytext").append(c),c.animate({opacity:"100%",backgroundColor:"yellow"},{duration:1e3,complete:function(){c.animate({backgroundColor:"white"})}}),S.add(o)}}let n=$(".parallellayout.col.main"),i=$(".parallellayout.col.side");i.is(":animated")||(i.is(":visible")?e():(n.css("flexBasis","100%"),i.css("flexBasis","0%"),i.show(),i.animate({flexBasis:"30%"},{duration:1e3,step:function(o,c){n.css("flexBasis",100-o+"%")},complete:e})))}$(".parallellayout.col.main").scroll(function(){let t=$(`.section.level2:eq(${u})`).find(".summary"),e=$(".bandContent.topicsListContainer").height();t.each(function(i,o){o.getBoundingClientRect().bottom<e&&N(i)});let n=this.scrollHeight-this.clientHeight;this.scrollTop>=n-10&&t.each(function(i,o){S.has(`${u}.${i}`)||N(i)})}),tt(),X(),et(),tutorial.onInit(function(){tutorial.onProgress(function(t){t.event==="section_completed"?nt(t.element):t.event==="section_skipped"&&U(t.element)})})});})();
//# sourceMappingURL=tutorial-format.js.map
