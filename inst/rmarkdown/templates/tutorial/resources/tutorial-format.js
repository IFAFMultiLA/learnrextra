(()=>{$(document).ready(function(){let T="",d=-1,D=!1,F=!1,r=[],L=new Set,B=!1,H=0,q=function(){let e=[];return{add:function(t,n){e.push({id:t,callback:n})},remove:function(t){e=e.filter(function(n){return t!==n.id})},invoke:function(){for(let t=0;t<e.length;t++)e[t].callback()}}}();function A(e,t){if(typeof t=="undefined"&&(t=!0),r.length===0||(e=e*1,e===d))return;if(d!==-1){let i=$(r[d].jqElement);i.trigger("hide"),i.removeClass("current"),i.trigger("hidden"),$(r[d].jqListElement).removeClass("current")}let n=$(r[e].jqElement);n.trigger("show"),n.addClass("current"),n.trigger("shown"),$(r[e].jqListElement).addClass("current"),d=e,t&&q.invoke(),setTimeout(function(){$(document).scrollTop(0)},0)}function y(e){let t=window.location.href.replace(window.location.hash,"");window.location=`${t}#${r[e].id}`,w(e-1)}function Z(e){N(),y(this.getAttribute("index"))}function G(){$(".topicsList").removeClass("hideFloating")}function N(){$(".topicsList").addClass("hideFloating")}function I(e){U();let t=r[e];if(!t.progressiveReveal)return;let n=!0,i=null;for(let c=0;c<t.sections.length;c++){let a=t.sections[c],s=$(a.jqElement);n?(s.trigger("show"),s.removeClass("hide"),s.trigger("shown"),a.skipped?s.removeClass("showSkip"):(s.addClass("showSkip"),i=s)):(s.trigger("hide"),s.addClass("hide"),s.trigger("hidden")),n=n&&a.skipped}!t.progressiveReveal||n?$(t.jqElement).removeClass("hideActions"):$(t.jqElement).addClass("hideActions"),B&&i&&(H=i.offset().top-28,setTimeout(function(){$("html, body").animate({scrollTop:H},300)},60)),B=!1}function j(e){let t=r[e],n=t.sections.length===0?!t.topicCompleted*100:(1-t.sectionsSkipped/t.sections.length)*100;$(t.jqListElement).css("background-position-y",n+"%")}function M(e){return i18next.language||window.localStorage.i18nextLng||e||"en"}function Q(e){$(this).data("n_clicks",$(this).data("n_clicks")+1);let t=this.getAttribute("data-section-id"),n=-1,i=-1,c,a;if($.each(r,function(s,l){return $.each(l.sections,function(o,p){if(t===p.id)return n=s,i=o,c=l,a=p,!1}),n===-1}),a.exercises.length&&!a.completed&&!a.allowSkip){let s=i18next.t(["text.exercise","exercise"],{count:a.exercises.length,lngs:[M(),"en"]}),l=i18next.t(["text.youmustcomplete","You must complete the"]),o=i18next.t(["text.inthissection","in this section before continuing."]);bootbox.setLocale(M()),bootbox.alert(l+" "+s+" "+o)}else i===c.sections.length-1?n<r.length-1&&y(d+1):B=!0,z([a.jqElement]),tutorial.skipSection(t)}function X(e){r[d].sections.length===0&&tutorial.skipSection(r[d].id),w(d),y(d+1)}function ee(e){y(d-1)}function te(){let e=$('<nav id="tutorial-topic" class="topicsList hideFloating" aria-label="topic"></nav>'),t=$('<header class="topicsHeader"></header>');t.append($('<h1 class="tutorialTitle">'+T+"</h1>"));let n=$('<div class="paneCloser"></div>');n.on("click",N),t.append(n),e.append(t);let i=O()?$('<ul class="nav nav-pills" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>'):$('<ul class="nav flex-column" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>');e.append(i),$("#doc-metadata").before(e),U();let c=$(".section.level2");c.each(function(s,l){let o={};o.id=$(l).attr("id"),o.exercisesCompleted=0,o.sectionsCompleted=0,o.sectionsSkipped=0,o.topicCompleted=!1,o.jqElement=l,o.jqTitleElement=$(l).children("h2")[0],o.titleText=o.jqTitleElement.innerText;let p=$(l).attr("data-progressive");typeof p!="undefined"&&p!==!1?o.progressiveReveal=p==="true"||p==="TRUE":o.progressiveReveal=D;let m=$(`<li class="topic${O()?"":" nav-item"}" index="${s}"><a href="#${o.id}" class = "nav-link" role="menuitem" tabindex="0">${o.titleText}</a></li>`);m.on("click",Z),o.jqListElement=m,$(i).append(m);let g=$('<div class="topicActions"></div>');if(s>0){let h=$('<button class="btn btn-default" data-i18n="button.previoustopic">Previous Topic</button>');h.on("click",ee),g.append(h)}if(s<c.length-1){let h=$('<button class="btn btn-primary" data-i18n="button.nexttopic">Next Topic</button>');h.on("click",X),g.append(h)}$(l).append(g),$(l).on("shown",function(){$(this).is(":visible")&&$(l).children(".section.level3").each(function(u,f){C(f)})}),$(l).on("hidden",function(){$(l).children(".section.level3").each(function(u,f){C(f)})}),o.sections=[],$(l).children(".section.level3").each(function(h,u){if(o.progressiveReveal){let V='data-i18n="button.continue"',k="Continue";u.dataset.continueText&&(k=u.dataset.continueText,V="");let b=$(`<button
              class="btn btn-default skip"
              id="continuebutton-${u.id}"
              data-section-id="${u.id}"
              ${V}
            >${k}</button>`);b.data("n_clicks",0),b.on("click",Q);let Y=$('<div class="exerciseActions"></div>');Y.append(b),$(u).append(Y)}$(u).on("shown",function(){C(u)}),$(u).on("hidden",function(){C(u)});let f={};f.exercises=[],$(u).children(".tutorial-exercise").each(function(V,k){let b={};b.dataLabel=$(k).attr("data-label"),b.completed=!1,b.jqElement=k,f.exercises.push(b)});let x=$(u).attr("data-allow-skip"),K=F;typeof x!="undefined"&&x!==!1&&(K=x="true"),f.id=u.id,f.completed=!1,f.allowSkip=K,f.skipped=!1,f.jqElement=u,o.sections.push(f)}),r.push(o)});let a=$('<li class="resetButton"><a href="#" data-i18n="text.startover">Start Over</a></li>');return a.on("click",function(){let s=i18next.t(["text.areyousure","Are you sure you want to start over? (all exercise progress will be reset)"]);bootbox.setLocale(M()),bootbox.confirm(s,function(l){l&&tutorial.startOver()})}),$("#doc-metadata-additional ul").prepend(a),e}let _=new Shiny.InputBinding;$.extend(_,{find:function(e){return $(e).find(".topicsList")},getValue:function(e){return d===-1?null:r[d].id},setValue:function(e,t){for(let n=0;n<r.length;n++)if(r[n].id===t){A(n,!1);break}},subscribe:function(e,t){q.add(e.id,t)},unsubscribe:function(e){q.remove(e.id)}}),Shiny.inputBindings.register(_,"learnr.topicMenuInputBinding");let P=new Shiny.InputBinding;$.extend(P,{find:function(e){return $(e).find(".exerciseActions > button.skip")},getId:function(e){return"continuebutton-"+e.getAttribute("data-section-id")},getValue:function(e){return $(e).data("n_clicks")},setValue:function(e,t){let n=$(e).data("n_clicks");t>n&&$(e).trigger("click"),$(e).data("n_clicks",t)},subscribe:function(e,t){$(e).on("click.continueButtonInputBinding",function(n){t(!1)})},unsubscribe:function(e){$(e).off(".continueButtonInputBinding")}}),Shiny.inputBindings.register(P,"learnr.continueButtonInputBinding");function ne(){T=$("title")[0].innerText;let e=$("meta[name=progressive]").attr("content");D=e==="true"||e==="TRUE";let t=$("meta[name=allow-skip]").attr("content");F=t==="true"||t==="TRUE";let n=$(`<h1 class="tutorialTitle">${T}</h1>`);n.on("click",G),$(".topics").prepend(n),$(".bandContent.topicsListContainer").append(te());for(let c=0;c<r.length;c++)I(c);ie();function i(){$(".topicsList").css("max-height",window.innerHeight)}i(),window.addEventListener("resize",i)}function ie(){$(".footnote-ref").replaceWith(function(){let e=$("<span>");return e.addClass($(this).class),e.append($(this).html()),e}),$(".footnote-back").remove()}function O(){return!window.bootstrap}function oe(){if(O())return;document.querySelectorAll(".btn-xs").forEach(n=>{n.classList.remove("btn-xs"),n.classList.add("btn-sm")}),document.querySelectorAll(".sr-only").forEach(n=>{n.classList.contains("visually-hidden-focusable")||n.classList.add("visually-hidden")});let e={panel:"card","panel-default":"","panel-heading":"card-header","panel-title":"card-title","panel-body":"card-body","panel-footer":"card-footer"},t=document.querySelectorAll(".tutorial-exercise-input, .tutorial-question-container");t.length!==0&&t.forEach(n=>{Object.keys(e).forEach(i=>{let c=[n,...n.querySelectorAll(`.${i}`)];if(!c.length)return;let a=e[i];c.forEach(s=>{!s.classList.contains(i)||(s.classList.remove(i),a!==""&&s.classList.add(a))})})})}function se(){function e(){let t=window.decodeURIComponent(window.location.hash),n=0;return t.length>0&&$.each(r,function(i,c){if("#"+c.id===t)return n=i,!1}),n}A(e()),w(d-1),window.addEventListener("popstate",function(t){A(e())})}function ce(e){let t=$(e),n=t.hasClass("level2"),i;n?i=t.attr("id"):i=$(t.parents(".section.level2")).attr("id");let c=-1;if($.each(r,function(s,l){if(l.id===i)return c=s,!1}),c===-1){console.log('topic "'+i+'" not found');return}let a=r[c];if(n)a.topicCompleted=!0,j(c);else{let s=-1,l=t.attr("id");if($.each(a.sections,function(p,m){if(m.id===l)return s=p,!1}),s===-1){console.log('completed section"'+l+'"not found');return}let o=a.sections[s];o.completed||(a.sectionsCompleted++,j(c),$(o.jqElement).addClass("done"),o.completed=!0,I(c))}}let v=[];function U(){v.splice(0,v.length),R()}function C(e){let t=v.indexOf(e.id);$(e).is(":visible")?t===-1&&(v.push(e.id),R()):t!==-1&&(v.splice(t,1),R())}function R(){Shiny&&Shiny.setInputValue?Shiny.setInputValue("tutorial-visible-sections",v):$(document).on("shiny:sessioninitialized",function(){Shiny.setInputValue("tutorial-visible-sections",v)})}function z(e){let t;if(e.length)t=e[0].id;else{console.log("section "+$(e).selector.split('"')[1]+" not found");return}let n=-1;$.each(r,function(i,c){return t===c.id?(n=i,c.topicCompleted=!0,!1):($.each(c.sections,function(a,s){if(t===s.id)return n=i,s.skipped=!0,c.sectionsSkipped++,!1}),n===-1)}),j(n),I(n)}function le(e){let t=0,n=0,i=e.length;for(;n<i;)t=(t<<5)-t+e.charCodeAt(n++)<<0;return t+2147483647+1}function E(e,t){let n=$(".parallellayout.col.main"),i=$(".parallellayout.col.side");i.is(":visible")||(n.css("flexBasis","100%"),i.css("flexBasis","0%"),i.show(),i.animate({flexBasis:"30%"},{duration:1e3,step:function(s,l){n.css("flexBasis",100-s+"%")},complete:()=>introJs().setOptions({dontShowAgain:!0,nextLabel:"Weiter",prevLabel:"Zur\xFCck",doneLabel:"Fertig",stepNumbersOfLabel:"von",dontShowAgainLabel:"Nicht wieder anzeigen"}).start()}));let c=`${e}.${t}`,a=$("#summarytext");if(!L.has(c)){let s=$(`.section.level2:eq(${e})  .summary:eq(${t})`),l=s.children().detach(),o=null,p=!1;for(let m=0;m<l.length;m++){let g=l[m],J=$(g).hasClass("replace")||s.hasClass("replace"),h=g.tagName==="DIV"?$(g).children():[g];for(let u=0;u<h.length;u++){let f=h[u],S=$(f);if(f.tagName==="H4"){o!==null&&(o.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),a.append(o));let x="summaryContainer_"+le(S.text());o=a.find("."+x),o.length===0&&(o=$(`<div class="${x}"></div>`),o.append(S),p=!0)}else o!==null?(J&&o.find(":not(h4)").remove(),o.append(S)):console.error("invalid summary definition (no summary section provided before)");o!==null&&m>=l.length-1&&(o.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),p&&(a.append(o),p=!1))}}L.add(c)}}function w(e){for(let t=0;t<=e;t++){let n=$(`.section.level2:eq(${t})`).find(".summary");for(let i=0;i<n.length;i++)L.has(`${t}.${i}`)||E(t,i)}}$(".parallellayout.col.main").scroll(function(){let e=$(`.section.level2:eq(${d})`).find(".summary"),t=$(".bandContent.topicsListContainer").height();e.each(function(i,c){c.getBoundingClientRect().bottom<t&&E(d,i)});let n=this.scrollHeight-this.clientHeight;this.scrollTop>=n-10&&w(d)});function W(e){let t=Math.floor(e-$(".topicsContainer").height());$(".parallellayout.row").height(t)}$(window).on("hashchange",function(){w(d-1)}),$(window).on("resize",function(){W($(this).height())}),oe(),ne(),se(),W($(window).height()),tutorial.onInit(function(){tutorial.onProgress(function(e){e.event==="section_completed"?ce(e.element):e.event==="section_skipped"&&z(e.element)})})});})();
//# sourceMappingURL=tutorial-format.js.map
