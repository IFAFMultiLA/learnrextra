(()=>{var ve=Object.defineProperty;var te=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ne=(d,c,r)=>c in d?ve(d,c,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[c]=r,U=(d,c)=>{for(var r in c||(c={}))we.call(c,r)&&ne(d,r,c[r]);if(te)for(var r of te(c))Ce.call(c,r)&&ne(d,r,c[r]);return d};var ie=(d,c,r)=>new Promise((b,u)=>{var B=x=>{try{q(r.next(x))}catch(y){u(y)}},M=x=>{try{q(r.throw(x))}catch(y){u(y)}},q=x=>x.done?b(x.value):Promise.resolve(x.value).then(B,M);q((r=r.apply(d,c)).next())});function se(d,c){$("#chatview > .messages").append(`<div class="msg ${d}">${nl2br(c)}</div>`);let r=$("#chatview > .messages > .msg.user:last")[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,r])}function oe(d){se("system",d),$("#chatview > .controls > button").attr("disabled",!1)}function xe(d){$("#chatview > .controls > button").attr("disabled",!0),se("user",d)}function ye(){return ie(this,null,function*(){let d=$("#chatview > .controls > button").attr("disabled")!=="disabled",c=$("#chatview > .controls > textarea"),r=c.val().trim();if(r!==""&&d){xe(r),c.val("");try{yield postChatbotMessage(sess,tracking_session_id,sessdata.user_code,r).then(b=>{if(b.ok)return b.json();throw new Error("Posting the chat message failed.")}).then(function(b){oe(b.message)})}catch(b){oe("Sorry, there is currently a problem with the learning assistant service."),console.log("error communicating with the chat service:",b)}}})}$(document).ready(function(){let d="",c=-1,r=!1,b=!1,u=[],B=_.defaults(sessdata.app_config,{summary:!0,reset_button:!0,chatbot:!0}),M=_.defaults(B.summary,!0).valueOf(),q=_.defaults(B.reset_button,!0).valueOf(),x=_.defaults(B.reset_button,!0).valueOf(),y=new Set,R=!1,z=0,ae=["h2","h3","h4","h5","h6","p","ul","ol","div.figure","div.section"].map(e=>".section.level2 > "+e).join(", ");$(ae).each(function(e,t){$(t).prop("id",`mainContentElem-${e}`).addClass("mainContentElem")}),x&&($("#chatview").show(),$("#chatview > .header").on("click",function(){$("#chatview").hasClass("opened")?$("#chatview").removeClass("opened").addClass("closed"):$("#chatview").removeClass("closed").addClass("opened")}),$("#chatview > .controls > button").on("click",ye));let E=function(){let e=[];return{add:function(t,n){e.push({id:t,callback:n})},remove:function(t){e=e.filter(function(n){return t!==n.id})},invoke:function(){for(let t=0;t<e.length;t++)e[t].callback()}}}();function H(e,t){if(typeof t=="undefined"&&(t=!0),u.length===0||(e=e*1,e===c))return;if(c!==-1){let i=$(u[c].jqElement);i.trigger("hide"),i.removeClass("current"),i.trigger("hidden"),$(u[c].jqListElement).removeClass("current")}let n=$(u[e].jqElement);n.trigger("show"),n.addClass("current"),n.trigger("shown"),$(u[e].jqListElement).addClass("current"),c=e,t&&E.invoke(),setTimeout(function(){$(document).scrollTop(0)},0)}function A(e,t){let n=window.location.href.replace(window.location.hash,"");if(window.location=`${n}#${u[e].id}`,t===void 0)$("#learnr-tutorial-content").parent().scrollTop(0);else{let i=$(`#${t}`)[0],a=Math.max(i.offsetTop-i.offsetHeight-60,0);$("#learnr-tutorial-content").parent().scrollTop(a)}j(e-1)}function ce(e){J(),A(this.getAttribute("index"))}function le(){$(".topicsList").removeClass("hideFloating")}function J(){$(".topicsList").addClass("hideFloating")}function V(e){K();let t=u[e];if(!t.progressiveReveal)return;let n=!0,i=null;for(let a=0;a<t.sections.length;a++){let l=t.sections[a],o=$(l.jqElement);n?(o.trigger("show"),o.removeClass("hide"),o.trigger("shown"),l.skipped?o.removeClass("showSkip"):(o.addClass("showSkip"),i=o)):(o.trigger("hide"),o.addClass("hide"),o.trigger("hidden")),n=n&&l.skipped}!t.progressiveReveal||n?$(t.jqElement).removeClass("hideActions"):$(t.jqElement).addClass("hideActions"),R&&i&&(z=i.offset().top-28,setTimeout(function(){$("html, body").animate({scrollTop:z},300)},60)),R=!1}function D(e){let t=u[e],n=t.sections.length===0?!t.topicCompleted*100:(1-t.sectionsSkipped/t.sections.length)*100;$(t.jqListElement).css("background-position-y",n+"%")}function F(e){return i18next.language||window.localStorage.i18nextLng||e||"en"}function re(e){$(this).data("n_clicks",$(this).data("n_clicks")+1);let t=this.getAttribute("data-section-id"),n=-1,i=-1,a,l;if($.each(u,function(o,s){return $.each(s.sections,function(p,g){if(t===g.id)return n=o,i=p,a=s,l=g,!1}),n===-1}),l.exercises.length&&!l.completed&&!l.allowSkip){let o=i18next.t(["text.exercise","exercise"],{count:l.exercises.length,lngs:[F(),"en"]}),s=i18next.t(["text.youmustcomplete","You must complete the"]),p=i18next.t(["text.inthissection","in this section before continuing."]);bootbox.setLocale(F()),bootbox.alert(s+" "+o+" "+p)}else i===a.sections.length-1?n<u.length-1&&A(c+1):R=!0,Y([l.jqElement]),tutorial.skipSection(t)}function ue(e){u[c].sections.length===0&&tutorial.skipSection(u[c].id),j(c),A(c+1)}function de(e){A(c-1)}function fe(){let e=$('<nav id="tutorial-topic" class="topicsList hideFloating" aria-label="topic"></nav>'),t=$('<header class="topicsHeader"></header>'),n=$('<div class="paneCloser"></div>');n.on("click",J),t.append(n),e.append(t);let i=N()?$('<ul class="nav nav-pills" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>'):$('<ul class="nav flex-column" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>');e.append(i),$("#doc-metadata").before(e),K();let a=$(".section.level2");if(a.each(function(l,o){let s={};s.id=$(o).attr("id"),s.exercisesCompleted=0,s.sectionsCompleted=0,s.sectionsSkipped=0,s.topicCompleted=!1,s.jqElement=o,s.jqTitleElement=$(o).children("h2")[0],s.titleText=s.jqTitleElement.innerText;let p=$(o).attr("data-progressive");typeof p!="undefined"&&p!==!1?s.progressiveReveal=p==="true"||p==="TRUE":s.progressiveReveal=r;let g=$(`<li class="topic${N()?"":" nav-item"}" index="${l}"><a href="#${s.id}" class = "nav-link" role="menuitem" tabindex="0">${s.titleText}</a></li>`);g.on("click",ce),s.jqListElement=g,$(i).append(g);let h=$('<div class="topicActions"></div>');if(l>0){let v=$('<button class="btn btn-default" data-i18n="button.previoustopic">Previous Topic</button>');v.on("click",de),h.append(v)}if(l<a.length-1){let v=$('<button class="btn btn-primary" data-i18n="button.nexttopic">Next Topic</button>');v.on("click",ue),h.append(v)}$(o).append(h),$(o).on("shown",function(){$(this).is(":visible")&&$(o).children(".section.level3").each(function(f,m){I(m)})}),$(o).on("hidden",function(){$(o).children(".section.level3").each(function(f,m){I(m)})}),s.sections=[],$(o).children(".section.level3").each(function(v,f){if(s.progressiveReveal){let L='data-i18n="button.continue"',C="Continue";f.dataset.continueText&&(C=f.dataset.continueText,L="");let w=$(`<button
              class="btn btn-default skip"
              id="continuebutton-${f.id}"
              data-section-id="${f.id}"
              ${L}
            >${C}</button>`);w.data("n_clicks",0),w.on("click",re);let ee=$('<div class="exerciseActions"></div>');ee.append(w),$(f).append(ee)}$(f).on("shown",function(){I(f)}),$(f).on("hidden",function(){I(f)});let m={};m.exercises=[],$(f).children(".tutorial-exercise").each(function(L,C){let w={};w.dataLabel=$(C).attr("data-label"),w.completed=!1,w.jqElement=C,m.exercises.push(w)});let S=$(f).attr("data-allow-skip"),T=b;typeof S!="undefined"&&S!==!1&&(T=S="true"),m.id=f.id,m.completed=!1,m.allowSkip=T,m.skipped=!1,m.jqElement=f,s.sections.push(m)}),u.push(s)}),q){let l=$('<li class="resetButton"><a href="#" data-i18n="text.startover">Start Over</a></li>');l.on("click",function(){let o=i18next.t(["text.areyousure","Are you sure you want to start over? (all exercise progress will be reset)"]);bootbox.setLocale(F()),bootbox.confirm(o,function(s){s&&tutorial.startOver()})}),$("#doc-metadata-additional ul").prepend(l)}return e}let Q=new Shiny.InputBinding;$.extend(Q,{find:function(e){return $(e).find(".topicsList")},getValue:function(e){return c===-1?null:u[c].id},setValue:function(e,t){for(let n=0;n<u.length;n++)if(u[n].id===t){H(n,!1);break}},subscribe:function(e,t){E.add(e.id,t)},unsubscribe:function(e){E.remove(e.id)}}),Shiny.inputBindings.register(Q,"learnr.topicMenuInputBinding");let W=new Shiny.InputBinding;$.extend(W,{find:function(e){return $(e).find(".exerciseActions > button.skip")},getId:function(e){return"continuebutton-"+e.getAttribute("data-section-id")},getValue:function(e){return $(e).data("n_clicks")},setValue:function(e,t){let n=$(e).data("n_clicks");t>n&&$(e).trigger("click"),$(e).data("n_clicks",t)},subscribe:function(e,t){$(e).on("click.continueButtonInputBinding",function(n){t(!1)})},unsubscribe:function(e){$(e).off(".continueButtonInputBinding")}}),Shiny.inputBindings.register(W,"learnr.continueButtonInputBinding");function pe(){d=$("title")[0].innerText;let e=$("meta[name=progressive]").attr("content");r=e==="true"||e==="TRUE";let t=$("meta[name=allow-skip]").attr("content");b=t==="true"||t==="TRUE";let n=$(`<h1 class="tutorialTitle">${d}</h1>`);n.on("click",le),$(".topics").prepend(n),$(".bandContent.topicsListContainer").append(fe());for(let a=0;a<u.length;a++)V(a);he();function i(){$(".topicsList").css("max-height",window.innerHeight)}i(),window.addEventListener("resize",i)}function he(){$(".footnote-ref").replaceWith(function(){let e=$("<span>");return e.addClass($(this).class),e.append($(this).html()),e}),$(".footnote-back").remove()}function N(){return!window.bootstrap}function me(){if(N())return;document.querySelectorAll(".btn-xs").forEach(n=>{n.classList.remove("btn-xs"),n.classList.add("btn-sm")}),document.querySelectorAll(".sr-only").forEach(n=>{n.classList.contains("visually-hidden-focusable")||n.classList.add("visually-hidden")});let e={panel:"card","panel-default":"","panel-heading":"card-header","panel-title":"card-title","panel-body":"card-body","panel-footer":"card-footer"},t=document.querySelectorAll(".tutorial-exercise-input, .tutorial-question-container");t.length!==0&&t.forEach(n=>{Object.keys(e).forEach(i=>{let a=[n,...n.querySelectorAll(`.${i}`)];if(!a.length)return;let l=e[i];a.forEach(o=>{!o.classList.contains(i)||(o.classList.remove(i),l!==""&&o.classList.add(l))})})})}function $e(){function e(){let t=window.decodeURIComponent(window.location.hash),n=0;return t.length>0&&$.each(u,function(i,a){if("#"+a.id===t)return n=i,!1}),n}H(e()),j(c-1),window.addEventListener("popstate",function(t){H(e())})}function ge(e){let t=$(e),n=t.hasClass("level2"),i;n?i=t.attr("id"):i=$(t.parents(".section.level2")).attr("id");let a=-1;if($.each(u,function(o,s){if(s.id===i)return a=o,!1}),a===-1){console.log('topic "'+i+'" not found');return}let l=u[a];if(n)l.topicCompleted=!0,D(a);else{let o=-1,s=t.attr("id");if($.each(l.sections,function(g,h){if(h.id===s)return o=g,!1}),o===-1){console.log('completed section"'+s+'"not found');return}let p=l.sections[o];p.completed||(l.sectionsCompleted++,D(a),$(p.jqElement).addClass("done"),p.completed=!0,V(a))}}let k=[];function K(){k.splice(0,k.length),P()}function I(e){let t=k.indexOf(e.id);$(e).is(":visible")?t===-1&&(k.push(e.id),P()):t!==-1&&(k.splice(t,1),P())}function P(){Shiny&&Shiny.setInputValue?Shiny.setInputValue("tutorial-visible-sections",k):$(document).on("shiny:sessioninitialized",function(){Shiny.setInputValue("tutorial-visible-sections",k)})}function Y(e){let t;if(e.length)t=e[0].id;else{console.log("section "+$(e).selector.split('"')[1]+" not found");return}let n=-1;$.each(u,function(i,a){return t===a.id?(n=i,a.topicCompleted=!0,!1):($.each(a.sections,function(l,o){if(t===o.id)return n=i,o.skipped=!0,a.sectionsSkipped++,!1}),n===-1)}),D(n),V(n)}function be(e){let t=0,n=0,i=e.length;for(;n<i;)t=(t<<5)-t+e.charCodeAt(n++)<<0;return t+2147483647+1}function Z(e,t){if(!M)return;let n=$(".parallellayout.col.main"),i=$(".parallellayout.col.side");if(!i.is(":visible")){let s={dontShowAgain:!0};if(config.language==="de"){let p={nextLabel:"Weiter",prevLabel:"Zur\xFCck",doneLabel:"Fertig",stepNumbersOfLabel:"von",dontShowAgainLabel:"Nicht wieder anzeigen"};s=U(U({},s),p)}n.css("flexBasis","100%"),i.css("flexBasis","0%"),i.show(),i.animate({flexBasis:"30%"},{duration:1e3,step:function(p,g){n.css("flexBasis",100-p+"%")},complete:function(){tracking_config.summary&&postEvent(sess,tracking_session_id,sessdata.user_code,"summary_shown"),MathJax.Hub.Queue(["Rerender",MathJax.Hub]),$(".shiny-plot-output").each(()=>Shiny.renderContent(this.id)),introJs().setOptions(s).start()}})}let a=`${e}.${t}`,l=$("#summarytext"),o=null;if(!y.has(a)){let s=$(`.section.level2:eq(${e})  .summary:eq(${t})`),p=s.prevAll(".mainContentElem").first()||s.nextAll(".mainContentElem").first();o=s.prop("id");let g=s.children().detach(),h=null,O=!1;for(let f=0;f<g.length;f++){let m=g[f],X=$(m).hasClass("replace")||s.hasClass("replace"),S=m.tagName==="DIV"?$(m).children():[m];for(let T=0;T<S.length;T++){let L=S[T],C=$(L);if(L.tagName==="H4"){h!==null&&(h.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),l.append(h));let w="summaryContainer_"+be(C.text());C.on("click",function(){A(e,p.length?p.prop("id"):void 0)}),h=l.find("."+w),h.length===0&&(h=$(`<div class="${w}"></div>`),h.append(C),O=!0)}else h!==null?(X&&h.find(":not(h4)").remove(),h.append(C)):console.error("invalid summary definition (no summary section provided before)");h!==null&&f>=g.length-1&&(h.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),O&&(l.append(h),O=!1))}}tracking_config.summary&&postEvent(sess,tracking_session_id,sessdata.user_code,"summary_topic_added",{key:a,id:o});let v=l.parent();v.animate({scrollTop:v.prop("scrollHeight")},1e3),y.add(a)}}function j(e){if(!!M)for(let t=0;t<=e;t++){let n=$(`.section.level2:eq(${t})`).find(".summary");for(let i=0;i<n.length;i++)y.has(`${t}.${i}`)||Z(t,i)}}function G(e){let t=Math.floor(e-$(".topicsContainer").height());$(".parallellayout.row").height(t-24)}M&&($(".parallellayout.col.main").scroll(function(){let e=$(`.section.level2:eq(${c})`).find(".summary"),t=$(".bandContent.topicsListContainer").height();e.each(function(i,a){a.getBoundingClientRect().bottom<t&&Z(c,i)});let n=this.scrollHeight-this.clientHeight;this.scrollTop>=n-10&&j(c)}),$(window).on("hashchange",function(){j(c-1)})),$(window).on("resize",function(){G($(this).height())}),me(),pe(),$e(),G($(window).height()),setTimeout(function(){$(".btn-tutorial-run").removeClass("disabled")},5e3),tutorial.onInit(function(){tutorial.onProgress(function(e){e.event==="section_completed"?ge(e.element):e.event==="section_skipped"&&Y(e.element)})})});})();
//# sourceMappingURL=tutorial-format.js.map
