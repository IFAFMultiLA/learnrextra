(()=>{$(document).ready(function(){let T="",d=-1,O=!1,_=!1,r=[],L=new Set,B=!1,F=0,q=function(){let t=[];return{add:function(e,n){t.push({id:e,callback:n})},remove:function(e){t=t.filter(function(n){return e!==n.id})},invoke:function(){for(let e=0;e<t.length;e++)t[e].callback()}}}();function A(t,e){if(typeof e=="undefined"&&(e=!0),r.length===0||(t=t*1,t===d))return;if(d!==-1){let i=$(r[d].jqElement);i.trigger("hide"),i.removeClass("current"),i.trigger("hidden"),$(r[d].jqListElement).removeClass("current")}let n=$(r[t].jqElement);n.trigger("show"),n.addClass("current"),n.trigger("shown"),$(r[t].jqListElement).addClass("current"),d=t,e&&q.invoke(),setTimeout(function(){$(document).scrollTop(0)},0)}function w(t){let e=window.location.href.replace(window.location.hash,"");window.location=`${e}#${r[t].id}`,k(t-1)}function G(t){H(),w(this.getAttribute("index"))}function J(){$(".topicsList").removeClass("hideFloating")}function H(){$(".topicsList").addClass("hideFloating")}function I(t){U();let e=r[t];if(!e.progressiveReveal)return;let n=!0,i=null;for(let c=0;c<e.sections.length;c++){let a=e.sections[c],s=$(a.jqElement);n?(s.trigger("show"),s.removeClass("hide"),s.trigger("shown"),a.skipped?s.removeClass("showSkip"):(s.addClass("showSkip"),i=s)):(s.trigger("hide"),s.addClass("hide"),s.trigger("hidden")),n=n&&a.skipped}!e.progressiveReveal||n?$(e.jqElement).removeClass("hideActions"):$(e.jqElement).addClass("hideActions"),B&&i&&(F=i.offset().top-28,setTimeout(function(){$("html, body").animate({scrollTop:F},300)},60)),B=!1}function j(t){let e=r[t],n=e.sections.length===0?!e.topicCompleted*100:(1-e.sectionsSkipped/e.sections.length)*100;$(e.jqListElement).css("background-position-y",n+"%")}function M(t){return i18next.language||window.localStorage.i18nextLng||t||"en"}function Q(t){$(this).data("n_clicks",$(this).data("n_clicks")+1);let e=this.getAttribute("data-section-id"),n=-1,i=-1,c,a;if($.each(r,function(s,l){return $.each(l.sections,function(o,p){if(e===p.id)return n=s,i=o,c=l,a=p,!1}),n===-1}),a.exercises.length&&!a.completed&&!a.allowSkip){let s=i18next.t(["text.exercise","exercise"],{count:a.exercises.length,lngs:[M(),"en"]}),l=i18next.t(["text.youmustcomplete","You must complete the"]),o=i18next.t(["text.inthissection","in this section before continuing."]);bootbox.setLocale(M()),bootbox.alert(l+" "+s+" "+o)}else i===c.sections.length-1?n<r.length-1&&w(d+1):B=!0,E([a.jqElement]),tutorial.skipSection(e)}function X(t){r[d].sections.length===0&&tutorial.skipSection(r[d].id),k(d),w(d+1)}function Z(t){w(d-1)}function tt(){let t=$('<nav id="tutorial-topic" class="topicsList hideFloating" aria-label="topic"></nav>'),e=$('<header class="topicsHeader"></header>');e.append($('<h1 class="tutorialTitle">'+T+"</h1>"));let n=$('<div class="paneCloser"></div>');n.on("click",H),e.append(n),t.append(e);let i=R()?$('<ul class="nav nav-pills" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>'):$('<ul class="nav flex-column" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>');t.append(i),$("#doc-metadata").before(t),U();let c=$(".section.level2");c.each(function(s,l){let o={};o.id=$(l).attr("id"),o.exercisesCompleted=0,o.sectionsCompleted=0,o.sectionsSkipped=0,o.topicCompleted=!1,o.jqElement=l,o.jqTitleElement=$(l).children("h2")[0],o.titleText=o.jqTitleElement.innerText;let p=$(l).attr("data-progressive");typeof p!="undefined"&&p!==!1?o.progressiveReveal=p==="true"||p==="TRUE":o.progressiveReveal=O;let m=$(`<li class="topic${R()?"":" nav-item"}" index="${s}"><a href="#${o.id}" class = "nav-link" role="menuitem" tabindex="0">${o.titleText}</a></li>`);m.on("click",G),o.jqListElement=m,$(i).append(m);let g=$('<div class="topicActions"></div>');if(s>0){let h=$('<button class="btn btn-default" data-i18n="button.previoustopic">Previous Topic</button>');h.on("click",Z),g.append(h)}if(s<c.length-1){let h=$('<button class="btn btn-primary" data-i18n="button.nexttopic">Next Topic</button>');h.on("click",X),g.append(h)}$(l).append(g),$(l).on("shown",function(){$(this).is(":visible")&&$(l).children(".section.level3").each(function(u,f){C(f)})}),$(l).on("hidden",function(){$(l).children(".section.level3").each(function(u,f){C(f)})}),o.sections=[],$(l).children(".section.level3").each(function(h,u){if(o.progressiveReveal){let D='data-i18n="button.continue"',y="Continue";u.dataset.continueText&&(y=u.dataset.continueText,D="");let b=$(`<button
              class="btn btn-default skip"
              id="continuebutton-${u.id}"
              data-section-id="${u.id}"
              ${D}
            >${y}</button>`);b.data("n_clicks",0),b.on("click",Q);let Y=$('<div class="exerciseActions"></div>');Y.append(b),$(u).append(Y)}$(u).on("shown",function(){C(u)}),$(u).on("hidden",function(){C(u)});let f={};f.exercises=[],$(u).children(".tutorial-exercise").each(function(D,y){let b={};b.dataLabel=$(y).attr("data-label"),b.completed=!1,b.jqElement=y,f.exercises.push(b)});let x=$(u).attr("data-allow-skip"),W=_;typeof x!="undefined"&&x!==!1&&(W=x="true"),f.id=u.id,f.completed=!1,f.allowSkip=W,f.skipped=!1,f.jqElement=u,o.sections.push(f)}),r.push(o)});let a=$('<li class="resetButton"><a href="#" data-i18n="text.startover">Start Over</a></li>');return a.on("click",function(){let s=i18next.t(["text.areyousure","Are you sure you want to start over? (all exercise progress will be reset)"]);bootbox.setLocale(M()),bootbox.confirm(s,function(l){l&&tutorial.startOver()})}),$("#doc-metadata-additional ul").prepend(a),t}let N=new Shiny.InputBinding;$.extend(N,{find:function(t){return $(t).find(".topicsList")},getValue:function(t){return d===-1?null:r[d].id},setValue:function(t,e){for(let n=0;n<r.length;n++)if(r[n].id===e){A(n,!1);break}},subscribe:function(t,e){q.add(t.id,e)},unsubscribe:function(t){q.remove(t.id)}}),Shiny.inputBindings.register(N,"learnr.topicMenuInputBinding");let P=new Shiny.InputBinding;$.extend(P,{find:function(t){return $(t).find(".exerciseActions > button.skip")},getId:function(t){return"continuebutton-"+t.getAttribute("data-section-id")},getValue:function(t){return $(t).data("n_clicks")},setValue:function(t,e){let n=$(t).data("n_clicks");e>n&&$(t).trigger("click"),$(t).data("n_clicks",e)},subscribe:function(t,e){$(t).on("click.continueButtonInputBinding",function(n){e(!1)})},unsubscribe:function(t){$(t).off(".continueButtonInputBinding")}}),Shiny.inputBindings.register(P,"learnr.continueButtonInputBinding");function et(){T=$("title")[0].innerText;let t=$("meta[name=progressive]").attr("content");O=t==="true"||t==="TRUE";let e=$("meta[name=allow-skip]").attr("content");_=e==="true"||e==="TRUE";let n=$(`<h1 class="tutorialTitle">${T}</h1>`);n.on("click",J),$(".topics").prepend(n),$(".bandContent.topicsListContainer").append(tt());for(let c=0;c<r.length;c++)I(c);nt();function i(){$(".topicsList").css("max-height",window.innerHeight)}i(),window.addEventListener("resize",i)}function nt(){$(".footnote-ref").replaceWith(function(){let t=$("<span>");return t.addClass($(this).class),t.append($(this).html()),t}),$(".footnote-back").remove()}function R(){return!window.bootstrap}function it(){if(R())return;document.querySelectorAll(".btn-xs").forEach(n=>{n.classList.remove("btn-xs"),n.classList.add("btn-sm")}),document.querySelectorAll(".sr-only").forEach(n=>{n.classList.contains("visually-hidden-focusable")||n.classList.add("visually-hidden")});let t={panel:"card","panel-default":"","panel-heading":"card-header","panel-title":"card-title","panel-body":"card-body","panel-footer":"card-footer"},e=document.querySelectorAll(".tutorial-exercise-input, .tutorial-question-container");e.length!==0&&e.forEach(n=>{Object.keys(t).forEach(i=>{let c=[n,...n.querySelectorAll(`.${i}`)];if(!c.length)return;let a=t[i];c.forEach(s=>{!s.classList.contains(i)||(s.classList.remove(i),a!==""&&s.classList.add(a))})})})}function ot(){function t(){let e=window.decodeURIComponent(window.location.hash),n=0;return e.length>0&&$.each(r,function(i,c){if("#"+c.id===e)return n=i,!1}),n}A(t()),k(d-1),window.addEventListener("popstate",function(e){A(t())})}function st(t){let e=$(t),n=e.hasClass("level2"),i;n?i=e.attr("id"):i=$(e.parents(".section.level2")).attr("id");let c=-1;if($.each(r,function(s,l){if(l.id===i)return c=s,!1}),c===-1){console.log('topic "'+i+'" not found');return}let a=r[c];if(n)a.topicCompleted=!0,j(c);else{let s=-1,l=e.attr("id");if($.each(a.sections,function(p,m){if(m.id===l)return s=p,!1}),s===-1){console.log('completed section"'+l+'"not found');return}let o=a.sections[s];o.completed||(a.sectionsCompleted++,j(c),$(o.jqElement).addClass("done"),o.completed=!0,I(c))}}let v=[];function U(){v.splice(0,v.length),V()}function C(t){let e=v.indexOf(t.id);$(t).is(":visible")?e===-1&&(v.push(t.id),V()):e!==-1&&(v.splice(e,1),V())}function V(){Shiny&&Shiny.setInputValue?Shiny.setInputValue("tutorial-visible-sections",v):$(document).on("shiny:sessioninitialized",function(){Shiny.setInputValue("tutorial-visible-sections",v)})}function E(t){let e;if(t.length)e=t[0].id;else{console.log("section "+$(t).selector.split('"')[1]+" not found");return}let n=-1;$.each(r,function(i,c){return e===c.id?(n=i,c.topicCompleted=!0,!1):($.each(c.sections,function(a,s){if(e===s.id)return n=i,s.skipped=!0,c.sectionsSkipped++,!1}),n===-1)}),j(n),I(n)}function ct(t){let e=0,n=0,i=t.length;for(;n<i;)e=(e<<5)-e+t.charCodeAt(n++)<<0;return e+2147483647+1}function z(t,e){let n=$(".parallellayout.col.main"),i=$(".parallellayout.col.side");i.is(":visible")||(n.css("flexBasis","100%"),i.css("flexBasis","0%"),i.show(),i.animate({flexBasis:"30%"},{duration:1e3,step:function(s,l){n.css("flexBasis",100-s+"%")}}));let c=`${t}.${e}`,a=$("#summarytext");if(!L.has(c)){let s=$(`.section.level2:eq(${t})  .summary:eq(${e})`),l=s.children().detach(),o=null,p=!1;for(let m=0;m<l.length;m++){let g=l[m],K=$(g).hasClass("replace")||s.hasClass("replace"),h=g.tagName==="DIV"?$(g).children():[g];for(let u=0;u<h.length;u++){let f=h[u],S=$(f);if(f.tagName==="H4"){o!==null&&(o.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),a.append(o));let x="summaryContainer_"+ct(S.text());o=a.find("."+x),o.length===0&&(o=$(`<div class="${x}"></div>`),o.append(S),p=!0)}else o!==null?(K&&o.find(":not(h4)").remove(),o.append(S)):console.error("invalid summary definition (no summary section provided before)");o!==null&&m>=l.length-1&&(o.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),p&&(a.append(o),p=!1))}}L.add(c)}}function k(t){for(let e=0;e<=t;e++){let n=$(`.section.level2:eq(${e})`).find(".summary");for(let i=0;i<n.length;i++)L.has(`${e}.${i}`)||z(e,i)}}$(".parallellayout.col.main").scroll(function(){let t=$(`.section.level2:eq(${d})`).find(".summary"),e=$(".bandContent.topicsListContainer").height();t.each(function(i,c){c.getBoundingClientRect().bottom<e&&z(d,i)});let n=this.scrollHeight-this.clientHeight;this.scrollTop>=n-10&&k(d)}),$(window).on("hashchange",function(){k(d-1)}),it(),et(),ot(),tutorial.onInit(function(){tutorial.onProgress(function(t){t.event==="section_completed"?st(t.element):t.event==="section_skipped"&&E(t.element)})})});})();
//# sourceMappingURL=tutorial-format.js.map
