(()=>{$(document).ready(function(){let L="",u=-1,F=!1,N=!1,r=[],B=new Set,q=!1,_=0,A=function(){let e=[];return{add:function(t,n){e.push({id:t,callback:n})},remove:function(t){e=e.filter(function(n){return t!==n.id})},invoke:function(){for(let t=0;t<e.length;t++)e[t].callback()}}}();function I(e,t){if(typeof t=="undefined"&&(t=!0),r.length===0||(e=e*1,e===u))return;if(u!==-1){let i=$(r[u].jqElement);i.trigger("hide"),i.removeClass("current"),i.trigger("hidden"),$(r[u].jqListElement).removeClass("current")}let n=$(r[e].jqElement);n.trigger("show"),n.addClass("current"),n.trigger("shown"),$(r[e].jqListElement).addClass("current"),u=e,t&&A.invoke(),setTimeout(function(){$(document).scrollTop(0)},0)}function C(e){let t=window.location.href.replace(window.location.hash,"");window.location=`${t}#${r[e].id}`,w(e-1)}function Z(e){P(),C(this.getAttribute("index"))}function G(){$(".topicsList").removeClass("hideFloating")}function P(){$(".topicsList").addClass("hideFloating")}function j(e){E();let t=r[e];if(!t.progressiveReveal)return;let n=!0,i=null;for(let c=0;c<t.sections.length;c++){let l=t.sections[c],s=$(l.jqElement);n?(s.trigger("show"),s.removeClass("hide"),s.trigger("shown"),l.skipped?s.removeClass("showSkip"):(s.addClass("showSkip"),i=s)):(s.trigger("hide"),s.addClass("hide"),s.trigger("hidden")),n=n&&l.skipped}!t.progressiveReveal||n?$(t.jqElement).removeClass("hideActions"):$(t.jqElement).addClass("hideActions"),q&&i&&(_=i.offset().top-28,setTimeout(function(){$("html, body").animate({scrollTop:_},300)},60)),q=!1}function M(e){let t=r[e],n=t.sections.length===0?!t.topicCompleted*100:(1-t.sectionsSkipped/t.sections.length)*100;$(t.jqListElement).css("background-position-y",n+"%")}function O(e){return i18next.language||window.localStorage.i18nextLng||e||"en"}function Q(e){$(this).data("n_clicks",$(this).data("n_clicks")+1);let t=this.getAttribute("data-section-id"),n=-1,i=-1,c,l;if($.each(r,function(s,a){return $.each(a.sections,function(o,p){if(t===p.id)return n=s,i=o,c=a,l=p,!1}),n===-1}),l.exercises.length&&!l.completed&&!l.allowSkip){let s=i18next.t(["text.exercise","exercise"],{count:l.exercises.length,lngs:[O(),"en"]}),a=i18next.t(["text.youmustcomplete","You must complete the"]),o=i18next.t(["text.inthissection","in this section before continuing."]);bootbox.setLocale(O()),bootbox.alert(a+" "+s+" "+o)}else i===c.sections.length-1?n<r.length-1&&C(u+1):q=!0,W([l.jqElement]),tutorial.skipSection(t)}function X(e){r[u].sections.length===0&&tutorial.skipSection(r[u].id),w(u),C(u+1)}function ee(e){C(u-1)}function te(){let e=$('<nav id="tutorial-topic" class="topicsList hideFloating" aria-label="topic"></nav>'),t=$('<header class="topicsHeader"></header>');t.append($('<h1 class="tutorialTitle">'+L+"</h1>"));let n=$('<div class="paneCloser"></div>');n.on("click",P),t.append(n),e.append(t);let i=R()?$('<ul class="nav nav-pills" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>'):$('<ul class="nav flex-column" role="menubar" aria-orientation="vertical" aria-label="topic"></ul>');e.append(i),$("#doc-metadata").before(e),E();let c=$(".section.level2");c.each(function(s,a){let o={};o.id=$(a).attr("id"),o.exercisesCompleted=0,o.sectionsCompleted=0,o.sectionsSkipped=0,o.topicCompleted=!1,o.jqElement=a,o.jqTitleElement=$(a).children("h2")[0],o.titleText=o.jqTitleElement.innerText;let p=$(a).attr("data-progressive");typeof p!="undefined"&&p!==!1?o.progressiveReveal=p==="true"||p==="TRUE":o.progressiveReveal=F;let m=$(`<li class="topic${R()?"":" nav-item"}" index="${s}"><a href="#${o.id}" class = "nav-link" role="menuitem" tabindex="0">${o.titleText}</a></li>`);m.on("click",Z),o.jqListElement=m,$(i).append(m);let g=$('<div class="topicActions"></div>');if(s>0){let h=$('<button class="btn btn-default" data-i18n="button.previoustopic">Previous Topic</button>');h.on("click",ee),g.append(h)}if(s<c.length-1){let h=$('<button class="btn btn-primary" data-i18n="button.nexttopic">Next Topic</button>');h.on("click",X),g.append(h)}$(a).append(g),$(a).on("shown",function(){$(this).is(":visible")&&$(a).children(".section.level3").each(function(d,f){T(f)})}),$(a).on("hidden",function(){$(a).children(".section.level3").each(function(d,f){T(f)})}),o.sections=[],$(a).children(".section.level3").each(function(h,d){if(o.progressiveReveal){let H='data-i18n="button.continue"',S="Continue";d.dataset.continueText&&(S=d.dataset.continueText,H="");let b=$(`<button
              class="btn btn-default skip"
              id="continuebutton-${d.id}"
              data-section-id="${d.id}"
              ${H}
            >${S}</button>`);b.data("n_clicks",0),b.on("click",Q);let Y=$('<div class="exerciseActions"></div>');Y.append(b),$(d).append(Y)}$(d).on("shown",function(){T(d)}),$(d).on("hidden",function(){T(d)});let f={};f.exercises=[],$(d).children(".tutorial-exercise").each(function(H,S){let b={};b.dataLabel=$(S).attr("data-label"),b.completed=!1,b.jqElement=S,f.exercises.push(b)});let x=$(d).attr("data-allow-skip"),y=N;typeof x!="undefined"&&x!==!1&&(y=x="true"),f.id=d.id,f.completed=!1,f.allowSkip=y,f.skipped=!1,f.jqElement=d,o.sections.push(f)}),r.push(o)});let l=$('<li class="resetButton"><a href="#" data-i18n="text.startover">Start Over</a></li>');return l.on("click",function(){let s=i18next.t(["text.areyousure","Are you sure you want to start over? (all exercise progress will be reset)"]);bootbox.setLocale(O()),bootbox.confirm(s,function(a){a&&tutorial.startOver()})}),$("#doc-metadata-additional ul").prepend(l),e}let U=new Shiny.InputBinding;$.extend(U,{find:function(e){return $(e).find(".topicsList")},getValue:function(e){return u===-1?null:r[u].id},setValue:function(e,t){for(let n=0;n<r.length;n++)if(r[n].id===t){I(n,!1);break}},subscribe:function(e,t){A.add(e.id,t)},unsubscribe:function(e){A.remove(e.id)}}),Shiny.inputBindings.register(U,"learnr.topicMenuInputBinding");let z=new Shiny.InputBinding;$.extend(z,{find:function(e){return $(e).find(".exerciseActions > button.skip")},getId:function(e){return"continuebutton-"+e.getAttribute("data-section-id")},getValue:function(e){return $(e).data("n_clicks")},setValue:function(e,t){let n=$(e).data("n_clicks");t>n&&$(e).trigger("click"),$(e).data("n_clicks",t)},subscribe:function(e,t){$(e).on("click.continueButtonInputBinding",function(n){t(!1)})},unsubscribe:function(e){$(e).off(".continueButtonInputBinding")}}),Shiny.inputBindings.register(z,"learnr.continueButtonInputBinding");function ne(){L=$("title")[0].innerText;let e=$("meta[name=progressive]").attr("content");F=e==="true"||e==="TRUE";let t=$("meta[name=allow-skip]").attr("content");N=t==="true"||t==="TRUE";let n=$(`<h1 class="tutorialTitle">${L}</h1>`);n.on("click",G),$(".topics").prepend(n),$(".bandContent.topicsListContainer").append(te());for(let c=0;c<r.length;c++)j(c);ie();function i(){$(".topicsList").css("max-height",window.innerHeight)}i(),window.addEventListener("resize",i)}function ie(){$(".footnote-ref").replaceWith(function(){let e=$("<span>");return e.addClass($(this).class),e.append($(this).html()),e}),$(".footnote-back").remove()}function R(){return!window.bootstrap}function oe(){if(R())return;document.querySelectorAll(".btn-xs").forEach(n=>{n.classList.remove("btn-xs"),n.classList.add("btn-sm")}),document.querySelectorAll(".sr-only").forEach(n=>{n.classList.contains("visually-hidden-focusable")||n.classList.add("visually-hidden")});let e={panel:"card","panel-default":"","panel-heading":"card-header","panel-title":"card-title","panel-body":"card-body","panel-footer":"card-footer"},t=document.querySelectorAll(".tutorial-exercise-input, .tutorial-question-container");t.length!==0&&t.forEach(n=>{Object.keys(e).forEach(i=>{let c=[n,...n.querySelectorAll(`.${i}`)];if(!c.length)return;let l=e[i];c.forEach(s=>{!s.classList.contains(i)||(s.classList.remove(i),l!==""&&s.classList.add(l))})})})}function se(){function e(){let t=window.decodeURIComponent(window.location.hash),n=0;return t.length>0&&$.each(r,function(i,c){if("#"+c.id===t)return n=i,!1}),n}I(e()),w(u-1),window.addEventListener("popstate",function(t){I(e())})}function ce(e){let t=$(e),n=t.hasClass("level2"),i;n?i=t.attr("id"):i=$(t.parents(".section.level2")).attr("id");let c=-1;if($.each(r,function(s,a){if(a.id===i)return c=s,!1}),c===-1){console.log('topic "'+i+'" not found');return}let l=r[c];if(n)l.topicCompleted=!0,M(c);else{let s=-1,a=t.attr("id");if($.each(l.sections,function(p,m){if(m.id===a)return s=p,!1}),s===-1){console.log('completed section"'+a+'"not found');return}let o=l.sections[s];o.completed||(l.sectionsCompleted++,M(c),$(o.jqElement).addClass("done"),o.completed=!0,j(c))}}let v=[];function E(){v.splice(0,v.length),V()}function T(e){let t=v.indexOf(e.id);$(e).is(":visible")?t===-1&&(v.push(e.id),V()):t!==-1&&(v.splice(t,1),V())}function V(){Shiny&&Shiny.setInputValue?Shiny.setInputValue("tutorial-visible-sections",v):$(document).on("shiny:sessioninitialized",function(){Shiny.setInputValue("tutorial-visible-sections",v)})}function W(e){let t;if(e.length)t=e[0].id;else{console.log("section "+$(e).selector.split('"')[1]+" not found");return}let n=-1;$.each(r,function(i,c){return t===c.id?(n=i,c.topicCompleted=!0,!1):($.each(c.sections,function(l,s){if(t===s.id)return n=i,s.skipped=!0,c.sectionsSkipped++,!1}),n===-1)}),M(n),j(n)}function le(e){let t=0,n=0,i=e.length;for(;n<i;)t=(t<<5)-t+e.charCodeAt(n++)<<0;return t+2147483647+1}function J(e,t){let n=$(".parallellayout.col.main"),i=$(".parallellayout.col.side");i.is(":visible")||(n.css("flexBasis","100%"),i.css("flexBasis","0%"),i.show(),i.animate({flexBasis:"30%"},{duration:1e3,step:function(s,a){n.css("flexBasis",100-s+"%")},complete:()=>introJs().setOptions({dontShowAgain:!0,nextLabel:"Weiter",prevLabel:"Zur\xFCck",doneLabel:"Fertig",stepNumbersOfLabel:"von",dontShowAgainLabel:"Nicht wieder anzeigen"}).start()}));let c=`${e}.${t}`,l=$("#summarytext");if(!B.has(c)){let s=$(`.section.level2:eq(${e})  .summary:eq(${t})`),a=s.children().detach(),o=null,p=!1;for(let g=0;g<a.length;g++){let k=a[g],h=$(k).hasClass("replace")||s.hasClass("replace"),d=k.tagName==="DIV"?$(k).children():[k];for(let f=0;f<d.length;f++){let D=d[f],x=$(D);if(D.tagName==="H4"){o!==null&&(o.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),l.append(o));let y="summaryContainer_"+le(x.text());o=l.find("."+y),o.length===0&&(o=$(`<div class="${y}"></div>`),o.append(x),p=!0)}else o!==null?(h&&o.find(":not(h4)").remove(),o.append(x)):console.error("invalid summary definition (no summary section provided before)");o!==null&&g>=a.length-1&&(o.css("opacity","0%").animate({opacity:"100%"},{duration:1e3}),p&&(l.append(o),p=!1))}}let m=l.parent();m.animate({scrollTop:m.prop("scrollHeight")},1e3),B.add(c)}}function w(e){for(let t=0;t<=e;t++){let n=$(`.section.level2:eq(${t})`).find(".summary");for(let i=0;i<n.length;i++)B.has(`${t}.${i}`)||J(t,i)}}$(".parallellayout.col.main").scroll(function(){let e=$(`.section.level2:eq(${u})`).find(".summary"),t=$(".bandContent.topicsListContainer").height();e.each(function(i,c){c.getBoundingClientRect().bottom<t&&J(u,i)});let n=this.scrollHeight-this.clientHeight;this.scrollTop>=n-10&&w(u)});function K(e){let t=Math.floor(e-$(".topicsContainer").height());$(".parallellayout.row").height(t)}$(window).on("hashchange",function(){w(u-1)}),$(window).on("resize",function(){K($(this).height())}),oe(),ne(),se(),K($(window).height()),tutorial.onInit(function(){tutorial.onProgress(function(e){e.event==="section_completed"?ce(e.element):e.event==="section_skipped"&&W(e.element)})})});})();
//# sourceMappingURL=tutorial-format.js.map
